name: Download and Upload All Files as Artifact

on:
  workflow_dispatch:
    inputs:
      file_urls:
        description: 'Comma-separated list of URLs of files to download'
        required: true
      artifact_name: 
        description: 'Name of the artifact to upload'
        required: true

jobs:
  download_and_upload:
    runs-on: ubuntu-latest

    steps:
      # Checkout repo (可选)
      - name: Checkout repository
        uses: actions/checkout@v3

      # 安装 curl
      - name: Install curl
        run: sudo apt-get update && sudo apt-get install -y curl

      # 下载文件
      - name: Download files
        run: |
          IFS=',' read -r -a urls <<< "${{ github.event.inputs.file_urls }}"
          for url in "${urls[@]}"
          do
            filename=$(basename "$url")
            echo "Downloading $url as $filename"
            curl -L -o "$filename" "$url"
          done

      # 上传所有下载的文件
      - name: Upload all downloaded files
        uses: actions/upload-artifact@v4
        with:
          name: ${{ github.event.inputs.artifact_name }}
          path: '**/*'  # 上传当前目录下的所有文件，包括子目录中的文件
