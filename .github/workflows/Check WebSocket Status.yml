name: Check WS (2095)

on:
  workflow_dispatch:
    inputs:
      url:
        description: "WebSocket URL (e.g. http://xxx.workers.dev:2095/)"
        required: true
        default: "http://example.workers.dev:2095/"

jobs:
  check-ws:
    runs-on: ubuntu-latest

    steps:
      - name: Test WS handshake
        run: |
          set -e

          URL="${{ github.event.inputs.url }}"

          # 从 URL 中提取 host（去掉协议、端口、路径）
          HOST=$(echo "$URL" | sed -E 's#^https?://([^/:]+).*#\1#')

          echo "Target URL: $URL"
          echo "Host header: $HOST"

          STATUS=$(curl --http1.1 \
            --max-time 5 \
            --connect-timeout 5 \
            -s -o /dev/null -w "%{http_code}" \
            -H "Host: $HOST" \
            -H "Connection: Upgrade" \
            -H "Upgrade: websocket" \
            -H "Sec
